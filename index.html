<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tra c·ª©u PCCC Pro - QCVN 06:2022 (Sƒê 1:2023)</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #b91c1c;
            --sidebar-bg: #1e1f20;
            --sidebar-text: #e3e3e3;
            --bg: #ffffff;
            --card: #f0f4f9;
            --text: #1f1f1f;
            --border: #e5e7eb;
            --highlight: #fde047;
            --link: #0b57d0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 260px;
            background-color: var(--sidebar-bg);
            color: var(--sidebar-text);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            overflow-y: auto;
            border-right: 1px solid #333;
        }
        
        .brand {
            padding: 20px;
            font-size: 18px;
            font-weight: 700;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .menu-item {
            padding: 12px 20px;
            cursor: pointer;
            font-size: 14px;
            color: #c4c7c5;
            border-radius: 0 20px 20px 0;
            margin-right: 10px;
        }
        .menu-item:hover { background-color: #333; color: #fff; }
        .menu-item.active { background-color: #004a77; color: #c2e7ff; font-weight: 500; }
        .highlight-menu { color: #fbbf24 !important; font-weight: 600; }

        /* --- MAIN CONTENT --- */
        .main-content {
            flex-grow: 1;
            padding: 20px 40px;
            overflow-y: auto;
            background: #fff;
        }

        .section { display: none; max-width: 950px; margin: 0 auto; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* INPUT CARD */
        .card {
            background: #fff;
            border: 1px solid #dadce0;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px; 
            margin-bottom: 20px;
        }

        .form-section-title {
            grid-column: 1 / -1;
            font-size: 13px;
            font-weight: 700;
            color: #b91c1c;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eee;
            margin-bottom: 15px;
        }

        .input-group {
            margin-bottom: 12px;
        }

        label { 
            display: flex; 
            align-items: center;
            margin-bottom: 6px; 
            font-size: 14px; 
            font-weight: 500; 
            color: #3c4043; 
        }
        .label-note { font-size: 12px; color: #666; font-weight: 400; font-style: italic; margin-left: 4px; }
        
        /* INFO ICON STYLE */
        .info-icon {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #e8f0fe;
            color: var(--link);
            font-size: 11px;
            font-weight: bold;
            font-family: 'Times New Roman', serif;
            font-style: italic;
            margin-left: 6px;
            cursor: pointer;
            border: 1px solid #d2e3fc;
            transition: all 0.2s;
        }
        .info-icon:hover {
            background: var(--link);
            color: #fff;
            transform: scale(1.1);
        }

        input, select {
            width: 100%; padding: 10px;
            border: 1px solid #dadce0; border-radius: 4px;
            font-size: 14px; transition: 0.2s;
            box-sizing: border-box;
        }
        input:focus, select:focus { border-color: #1a73e8; outline: 2px solid rgba(26,115,232,0.2); }

        .btn {
            background: #0b57d0; color: #fff;
            padding: 12px; border: none; border-radius: 24px;
            font-weight: 500; cursor: pointer; width: 100%;
            transition: background 0.2s;
            font-size: 15px;
        }
        .btn:hover { background: #0842a0; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }

        /* --- REPORT STYLES --- */
        .report-card {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .report-title { font-size: 16px; font-weight: 700; color: #1f1f1f; }
        .status-badge { font-size: 12px; padding: 4px 12px; border-radius: 16px; font-weight: 500; }
        .st-ok { background: #e6f4ea; color: #137333; }
        .st-warn { background: #fef7e0; color: #ea8600; }
        .st-err { background: #fce8e6; color: #c5221f; }

        .calc-box {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            font-family: 'Roboto Mono', monospace;
            font-size: 13px;
            color: #444746;
            border-left: 3px solid #0b57d0;
            margin-top: 10px;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
        }
        .report-table td {
            padding: 8px 0;
            border-bottom: 1px dashed #eee;
            vertical-align: middle;
        }
        .report-label { color: #5f6368; font-size: 14px; }
        .report-val { font-weight: 600; color: #202124; font-size: 14px; text-align: right; }

        /* TABLES FOR LOOKUP IN MAIN VIEW */
        .lookup-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        .lookup-table th, .lookup-table td {
            border: 1px solid #e0e0e0;
            padding: 10px;
            text-align: left;
        }
        .lookup-table th {
            background-color: #f1f3f4;
            font-weight: 600;
            color: #444;
            vertical-align: middle;
        }
        .lookup-table tr:hover {
            background-color: #f8f9fa;
        }

        /* --- DOCUMENT VIEWER MODAL --- */
        .doc-modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(2px);
        }
        
        .doc-modal {
            background: #f0f2f5;
            width: 95%; max-width: 1100px; height: 95vh;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }

        .doc-header {
            background: #fff;
            padding: 12px 24px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            z-index: 10;
        }

        .doc-title { font-weight: 600; color: #444746; font-size: 14px; }
        .close-btn { cursor: pointer; padding: 8px; border-radius: 50%; border: none; background: none; }
        .close-btn:hover { background: #f1f3f4; }

        .doc-body {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            display: flex;
            flex-direction: column;
            gap: 40px;
            align-items: center;
            background: #525659;
        }

        .citation-group {
            width: 100%;
            max-width: 900px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding-bottom: 40px;
            border-bottom: 2px dashed #777;
        }
        
        .citation-group-title {
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            background: #333;
            padding: 8px 16px;
            border-radius: 4px;
            align-self: flex-start;
            position: sticky;
            top: 0;
            z-index: 5;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .doc-page {
            background: #fff;
            width: 100%; 
            min-height: 1000px;
            padding: 50px 60px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            box-sizing: border-box;
            font-family: 'Merriweather', serif;
            font-size: 14px;
            line-height: 1.6;
            color: #202124;
            position: relative;
            margin-bottom: 20px;
        }

        /* --- STYLES CHO B·∫¢NG TRONG MODAL --- */
        .doc-page table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-family: 'Roboto', sans-serif;
            font-size: 13px;
        }
        .doc-page th, .doc-page td {
            border: 1px solid #555;
            padding: 8px;
            text-align: left;
            vertical-align: top;
        }
        .doc-page th {
            background-color: #f5f5f5;
            font-weight: 700;
            text-align: center;
        }

        .doc-page-number {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            font-size: 12px; color: #9aa0a6; font-family: sans-serif;
        }
        
        .doc-page-header-text {
            position: absolute; top: 30px; right: 60px;
            font-size: 10px; color: #9aa0a6; text-transform: uppercase; font-family: sans-serif;
        }

        .page-label {
            position: absolute; top: -25px; left: 0;
            background: #444; color: #fff;
            padding: 4px 8px; border-radius: 4px 4px 0 0;
            font-size: 11px; font-family: sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .page-label.is-center { background: #b91c1c; font-weight: bold; }

        mark.highlight {
            background-color: rgba(253, 224, 71, 0.6);
            color: #000;
            padding: 2px 0;
            border-bottom: 2px solid #f59e0b;
        }

        @media (max-width: 768px) {
            body { flex-direction: column; height: auto; overflow: visible; }
            .sidebar { width: 100%; height: auto; }
            .main-content { padding: 15px; }
            .form-grid { grid-template-columns: 1fr; gap: 10px; }
        }
    </style>
</head>
<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <div class="brand"><span>üî•</span> PCCC PRO</div>
    
    <div style="padding: 15px 20px 5px; font-size: 11px; font-weight: 700; color: #8e918f;">C√îNG C·ª§ CH√çNH</div>
    <div class="menu-item active highlight-menu" onclick="showTab('tong-hop', this)">üìã T·ªïng h·ª£p & Ki·ªÉm tra</div>

    <div style="padding: 15px 20px 5px; font-size: 11px; font-weight: 700; color: #8e918f;">TRA C·ª®U NHANH</div>
    <div class="menu-item" onclick="showTab('nhom-nha', this)">üîç Nh√≥m nh√† (F)</div>
    <div class="menu-item" onclick="showTab('cong-nang-phong', this)">üè¢ Tra c·ª©u theo Ph√≤ng</div>
    <div class="menu-item" onclick="showTab('bac-chiu-lua', this)">üèóÔ∏è B·∫≠c Ch·ªãu L·ª≠a</div>
    <div class="menu-item" onclick="showTab('cau-kien', this)">üß± C·∫•u ki·ªán (B·∫£ng 1)</div>
    <div class="menu-item" onclick="showTab('thoat-nan', this)">üèÉ Tho√°t n·∫°n</div>
    <div class="menu-item" onclick="showTab('duong-xe', this)">üöë B√£i ƒë·ªó & ƒê∆∞·ªùng xe</div>
</div>

<!-- MAIN CONTENT -->
<div class="main-content">

    <!-- DASHBOARD T·ªîNG H·ª¢P -->
    <div id="tong-hop" class="section active">
        <h2 style="margin-top:0">Ki·ªÉm tra & T√≠nh to√°n PCCC</h2>
        
        <div class="card">
            <div class="form-grid">
                <!-- 1. QUY M√î -->
                <div>
                    <div class="form-section-title">1. Quy m√¥ c√¥ng tr√¨nh</div>
                    
                    <div style="display: flex; gap: 15px;">
                        <div class="input-group" style="flex:1">
                            <label>Chi·ªÅu cao PCCC (m):
                                <span class="info-icon" onclick='openDocViewer([{page:8, label:"M·ª•c 1.4.9 - Chi·ªÅu cao PCCC", highlights:["Chi·ªÅu cao PCCC"]}])'>i</span>
                            </label>
                            <input type="number" id="inp-height" placeholder="ƒê·∫øn m√©p d∆∞·ªõi c·ª≠a s·ªï...">
                        </div>
                        <div class="input-group" style="flex:1">
                            <label>S·ªë t·∫ßng:
                                <span class="info-icon" onclick='openDocViewer([{page:14, label:"M·ª•c 1.4.50 - S·ªë t·∫ßng nh√†", highlights:["S·ªë t·∫ßng nh√†"]}])'>i</span>
                            </label>
                            <input type="number" id="inp-floors" placeholder="G·ªìm c·∫£ h·∫ßm...">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Di·ªán t√≠ch x√¢y d·ª±ng (m¬≤):
                            <span class="info-icon" onclick='openDocViewer([{page:84, label:"M·ª•c A.1.2.1 - Di·ªán t√≠ch x√¢y d·ª±ng", highlights:["Di·ªán t√≠ch x√¢y d·ª±ng"]}])'>i</span>
                        </label>
                        <input type="number" id="inp-build-area" placeholder="Di·ªán t√≠ch chi·∫øm ƒë·∫•t...">
                    </div>

                    <div class="input-group">
                        <label>Di·ªán t√≠ch s√†n 1 t·∫ßng (m¬≤): <span class="label-note">(tra Ph·ª• l·ª•c H)</span>
                            <span class="info-icon" onclick='openDocViewer([{page:161, label:"M·ª•c H.6 - T√≠nh di·ªán t√≠ch khoang ch√°y", highlights:["Di·ªán t√≠ch m·ªôt t·∫ßng"]}])'>i</span>
                        </label>
                        <input type="number" id="inp-area" placeholder="VD: 800">
                    </div>

                    <div class="input-group">
                        <label>Kh·ªëi t√≠ch nh√† (m¬≥): <span class="label-note">(nh√† F5, c√¥ng c·ªông)</span>
                            <span class="info-icon" onclick='openDocViewer([{page:13, label:"M·ª•c 1.4.47 - Quy m√¥ kh·ªëi t√≠ch", highlights:["Quy m√¥ kh·ªëi t√≠ch"]}])'>i</span>
                        </label>
                        <input type="number" id="inp-volume" placeholder="T·ªïng kh·ªëi t√≠ch...">
                    </div>
                </div>

                <!-- 2. C√îNG NƒÇNG & KH√ÅC -->
                <div>
                    <!-- C√¥ng nƒÉng -->
                    <div class="form-section-title">2. C√¥ng nƒÉng & S·ª≠ d·ª•ng</div>
                    <div class="input-group">
                        <label>Lo·∫°i c√¥ng tr√¨nh:
                            <span class="info-icon" onclick='openDocViewer([{pages:[29,30,31], label:"B·∫£ng 6 - Ph√¢n nh√≥m nh√† theo c√¥ng nƒÉng", highlights:["F1.3", "F4.3"]}])'>i</span>
                        </label>
                        <select id="inp-function" onchange="toggleRiskInput()">
                            <option value="">-- Ch·ªçn --</option>
                            <option value="F1.3">F1.3 - Chung c∆∞</option>
                            <option value="F4.3">F4.3 - VƒÉn ph√≤ng</option>
                            <option value="F3.1">F3.1 - Th∆∞∆°ng m·∫°i</option>
                            <option value="F5.1">F5.1 - Nh√† x∆∞·ªüng</option>
                            <option value="F1.2">F1.2 - Kh√°ch s·∫°n</option>
                        </select>
                    </div>

                    <div id="risk-container" style="display:none;" class="input-group">
                        <label>H·∫°ng s·∫£n xu·∫•t (F5):
                            <span class="info-icon" onclick='openDocViewer([{page:105, label:"B·∫£ng C.1 - H·∫°ng nguy hi·ªÉm ch√°y", highlights:["H·∫°ng nguy hi·ªÉm ch√°y"]}])'>i</span>
                        </label>
                        <select id="inp-risk">
                            <option value="C">H·∫°ng C</option>
                            <option value="A">H·∫°ng A</option>
                            <option value="B">H·∫°ng B</option>
                            <option value="D">H·∫°ng D</option>
                            <option value="E">H·∫°ng E</option>
                        </select>
                    </div>

                    <!-- Tho√°t n·∫°n -->
                    <div class="form-section-title" style="margin-top:20px">3. Tho√°t n·∫°n & KC An to√†n</div>
                    <div class="input-group">
                        <label>T·ªïng s·ªë ng∆∞·ªùi (t·∫ßng ƒë√¥ng nh·∫•t):
                            <span class="info-icon" onclick='openDocViewer([{pages:[144,145], label:"B·∫£ng G.9 - H·ªá s·ªë kh√¥ng gian s√†n", highlights:["H·ªá s·ªë kh√¥ng gian s√†n"]}])'>i</span>
                        </label>
                        <input type="number" id="inp-people" placeholder="VD: 150">
                    </div>

                    <div style="display: flex; gap: 15px;">
                        <div class="input-group" style="flex:1">
                            <label>KC t·ªõi nh√† b√™n (m):
                                <span class="info-icon" onclick='openDocViewer([{pages:[119,120], label:"B·∫£ng E.1 - Kho·∫£ng c√°ch PCCC", highlights:["Kho·∫£ng c√°ch ph√≤ng ch√°y"]}] )'>i</span>
                            </label>
                            <input type="number" id="inp-dist" placeholder="VD: 6">
                        </div>
                        <div class="input-group" style="flex:1">
                            <label>B·∫≠c ch·ªãu l·ª≠a nh√† b√™n:
                                <span class="info-icon" onclick='openDocViewer([{pages:[26,27], label:"B·∫£ng 4 - B·∫≠c ch·ªãu l·ª≠a", highlights:["B·∫≠c ch·ªãu l·ª≠a"]}])'>i</span>
                            </label>
                            <select id="inp-neighbor-grade">
                                <option value="1">B·∫≠c I, II</option>
                                <option value="2">B·∫≠c III</option>
                                <option value="3">B·∫≠c IV, V</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Auto Grade Display -->
                    <div style="margin-top:15px; padding:10px; background:#e8f0fe; border-radius:6px; font-size:13px; border: 1px solid #d2e3fc;">
                        <span style="color:#1967d2; font-weight:bold">T·ª± ƒë·ªông x√°c ƒë·ªãnh s∆° b·ªô:</span><br>
                        B·∫≠c ch·ªãu l·ª≠a y√™u c·∫ßu: <span id="auto-grade-display" style="font-weight:bold; color:#b91c1c">---</span>
                    </div>
                </div>
            </div>
            <button class="btn" onclick="runCheckAll()">T√çNH TO√ÅN & HI·ªÇN TH·ªä CƒÇN C·ª®</button>
        </div>

        <div id="report-container" style="display:none">
            <!-- Results rendered here -->
        </div>
    </div>

    <!-- TRA C·ª®U THEO C√îNG NƒÇNG PH√íNG -->
    <div id="cong-nang-phong" class="section">
        <h2 style="margin-top:0">Tra c·ª©u nhanh theo C√¥ng nƒÉng Ph√≤ng</h2>
        
        <!-- B·∫£ng M·∫≠t ƒë·ªô ng∆∞·ªùi & Tho√°t n·∫°n -->
        <div class="card">
            <div class="form-section-title">1. M·∫≠t ƒë·ªô ng∆∞·ªùi & Kho·∫£ng c√°ch Tho√°t n·∫°n (B·∫£ng G.9 & G.2)</div>
            <div class="input-group">
                <input type="text" id="search-room-func" onkeyup="filterTable('table-room-func', 'search-room-func')" placeholder="üîç Nh·∫≠p t√™n ph√≤ng (vd: VƒÉn ph√≤ng, B·∫øp, Kho...)">
            </div>
            <table class="lookup-table" id="table-room-func">
                <thead>
                    <tr>
                        <th>Lo·∫°i ph√≤ng / C√¥ng nƒÉng</th>
                        <th>H·ªá s·ªë s√†n (m¬≤/ng∆∞·ªùi) <span class="info-icon" onclick='openDocViewer([{pages:[144,145], label:"B·∫£ng G.9", highlights:["H·ªá s·ªë kh√¥ng gian s√†n"]}])'>i</span></th>
                        <th>KC tho√°t n·∫°n Max (m) <sup>(*)</sup> <span class="info-icon" onclick='openDocViewer([{pages:[138,139], label:"B·∫£ng G.2a, G.2b", highlights:["Kho·∫£ng c√°ch gi·ªõi h·∫°n"]}])'>i</span></th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>VƒÉn ph√≤ng, Khu l√†m vi·ªác</td><td>6,0</td><td>50 (B·∫≠c I, II); 40 (B·∫≠c III, IV)</td></tr>
                    <tr><td>H·ªôi tr∆∞·ªùng, Ph√≤ng h·ªçp, ƒÇn u·ªëng</td><td>1,0</td><td>60 (B·∫≠c I, II); 40 (B·∫≠c IV)</td></tr>
                    <tr><td>S·∫£nh, Si√™u th·ªã, C·ª≠a h√†ng</td><td>3,0</td><td>60 (B·∫≠c I, II); 40 (B·∫≠c IV)</td></tr>
                    <tr><td>Ph√≤ng h·ªçc, ƒê√†o t·∫°o</td><td>1,5</td><td>50 (B·∫≠c I, II)</td></tr>
                    <tr><td>Ph√≤ng ng·ªß (Kh√°ch s·∫°n, Nh√† ·ªü)</td><td>8,0</td><td>40 (C·ª≠a gi·ªØa 2 thang); 25 (C·ª•t)</td></tr>
                    <tr><td>Gara √¥ t√¥</td><td>-</td><td>40 (C·ª≠a gi·ªØa 2 thang); 20 (C·ª•t)</td></tr>
                    <tr><td>Kho, L∆∞u tr·ªØ</td><td>30,0</td><td>Theo B·∫£ng G.3 (T√πy kh·ªëi t√≠ch)</td></tr>
                    <tr><td>Khu t·∫≠p th·ªÉ thao, Gym</td><td>5,0</td><td>-</td></tr>
                </tbody>
            </table>
            <div style="font-size:12px; color:#666; margin-top:5px">(*) Kho·∫£ng c√°ch max: T√≠nh t·ª´ c·ª≠a ph√≤ng ƒë·∫øn l·ªëi ra tho√°t n·∫°n g·∫ßn nh·∫•t (ƒë·ªëi v·ªõi ph√≤ng c√≥ c·ª≠a b·ªë tr√≠ ·ªü gi·ªØa c√°c bu·ªìng thang). Gi√° tr·ªã c√≥ th·ªÉ thay ƒë·ªïi t√πy m·∫≠t ƒë·ªô ng∆∞·ªùi.</div>
        </div>

        <!-- B·∫£ng Y√™u c·∫ßu V·∫≠t li·ªáu -->
        <div class="card">
            <div class="form-section-title">2. Y√™u c·∫ßu V·∫≠t li·ªáu Ho√†n thi·ªán & Trang tr√≠ (Ph·ª• l·ª•c B) <span class="info-icon" onclick='openDocViewer([{page:104, label:"B·∫£ng B.8 & B.9", highlights:["Ph·∫°m vi √°p d·ª•ng c·ªßa v·∫≠t li·ªáu"]}])'>i</span></div>
            <div style="margin-bottom:10px; font-size:13px">
                <strong>Quy ∆∞·ªõc c·∫•p nguy hi·ªÉm ch√°y:</strong><br>
                CV0: Kh√¥ng ch√°y | CV1: Ch√°y y·∫øu, √≠t kh√≥i | CV2-4: Ch√°y, kh√≥i trung b√¨nh/cao
            </div>
            <table class="lookup-table">
                <thead>
                    <tr>
                        <th rowspan="2">Khu v·ª±c / Ph√≤ng</th>
                        <th colspan="2">C·∫•p nguy hi·ªÉm ch√°y v·∫≠t li·ªáu t·ªëi thi·ªÉu (CV)</th>
                    </tr>
                    <tr>
                        <th>T∆∞·ªùng & Tr·∫ßn</th>
                        <th>S√†n</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background-color:#fef9c3">
                        <td colspan="3"><strong>Tr√™n ƒë∆∞·ªùng tho√°t n·∫°n (H√†nh lang, S·∫£nh, Thang b·ªô)</strong></td>
                    </tr>
                    <tr><td>Nh√† cao > 17 t·∫ßng (ho·∫∑c > 50m)</td><td>CV0 (Kh√¥ng ch√°y)</td><td>CV1</td></tr>
                    <tr><td>Nh√† cao 9-17 t·∫ßng (28-50m)</td><td>CV1</td><td>CV2</td></tr>
                    <tr><td>Nh√† th·∫•p t·∫ßng (< 9 t·∫ßng)</td><td>CV2</td><td>CV3</td></tr>
                    
                    <tr style="background-color:#fef9c3">
                        <td colspan="3"><strong>Trong ph√≤ng chung (H·ªôi tr∆∞·ªùng, CLB, Th∆∞∆°ng m·∫°i...)</strong></td>
                    </tr>
                    <tr><td>S·ª©c ch·ª©a > 800 ng∆∞·ªùi</td><td>CV0</td><td>CV2</td></tr>
                    <tr><td>S·ª©c ch·ª©a 300 - 800 ng∆∞·ªùi</td><td>CV1</td><td>CV2</td></tr>
                    <tr><td>S·ª©c ch·ª©a 50 - 300 ng∆∞·ªùi</td><td>CV2</td><td>CV3</td></tr>
                    <tr><td>Ph√≤ng Karaoke, V≈© tr∆∞·ªùng (F2.1)</td><td>CV1</td><td>CV2</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- TRA C·ª®U NH√ìM NH√Ä -->
    <div id="nhom-nha" class="section">
        <h2 style="margin-top:0">Tra c·ª©u Nh√≥m nh√† (Ph√¢n lo·∫°i c√¥ng tr√¨nh)</h2>
        <div class="card">
            <div class="input-group">
                <input type="text" id="search-nhom-nha" onkeyup="filterTable('table-nhom-nha', 'search-nhom-nha')" placeholder="üîç Nh·∫≠p m√£ (F1, F2...) ho·∫∑c t√™n nh√≥m nh√† ƒë·ªÉ t√¨m ki·∫øm...">
            </div>
            <table class="lookup-table" id="table-nhom-nha">
                <thead>
                    <tr>
                        <th width="15%">M√£ <span class="info-icon" onclick='openDocViewer([{pages:[29,30,31], label:"B·∫£ng 6 - Ph√¢n nh√≥m nh√†", highlights:["M·ª•c ƒë√≠ch s·ª≠ d·ª•ng"]}])'>i</span></th>
                        <th>M√¥ t·∫£ ch·ª©c nƒÉng</th>
                        <th>V√≠ d·ª• ƒëi·ªÉn h√¨nh</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>F1.1</td><td>Nh√† tr·∫ª, m·∫´u gi√°o, b·ªánh vi·ªán</td><td>B·ªánh vi·ªán n·ªôi tr√∫, tr∆∞·ªùng m·∫ßm non</td></tr>
                    <tr><td>F1.2</td><td>Kh√°ch s·∫°n, k√Ω t√∫c x√°</td><td>Kh√°ch s·∫°n, nh√† ngh·ªâ, KTX tr∆∞·ªùng h·ªçc</td></tr>
                    <tr><td>F1.3</td><td>Nh√† chung c∆∞</td><td>Chung c∆∞ cao t·∫ßng, th·∫•p t·∫ßng</td></tr>
                    <tr><td>F2.1</td><td>Nh√† h√°t, r·∫°p chi·∫øu phim</td><td>R·∫°p chi·∫øu phim, nh√† h√°t, c√¢u l·∫°c b·ªô</td></tr>
                    <tr><td>F3.1</td><td>Th∆∞∆°ng m·∫°i</td><td>Si√™u th·ªã, c·ª≠a h√†ng b√°ch h√≥a</td></tr>
                    <tr><td>F3.2</td><td>ƒÇn u·ªëng</td><td>Nh√† h√†ng, qu√°n ƒÉn, qu√°n c√† ph√™</td></tr>
                    <tr><td>F4.1</td><td>Tr∆∞·ªùng h·ªçc</td><td>Tr∆∞·ªùng ti·ªÉu h·ªçc, trung h·ªçc, ƒë·∫°i h·ªçc</td></tr>
                    <tr><td>F4.3</td><td>VƒÉn ph√≤ng</td><td>Tr·ª• s·ªü l√†m vi·ªác, vƒÉn ph√≤ng cho thu√™</td></tr>
                    <tr><td>F5.1</td><td>Nh√† s·∫£n xu·∫•t</td><td>Nh√† m√°y, x∆∞·ªüng s·∫£n xu·∫•t</td></tr>
                    <tr><td>F5.2</td><td>Nh√† kho</td><td>Kho h√†ng h√≥a, b√£i ƒë·ªó xe</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- TRA C·ª®U B·∫¨C CH·ªäU L·ª¨A -->
    <div id="bac-chiu-lua" class="section">
        <h2 style="margin-top:0">Tra c·ª©u B·∫≠c ch·ªãu l·ª≠a (Ph·ª• l·ª•c H)</h2>
        <div class="card">
             <div class="form-section-title">1. ƒê·ªëi v·ªõi Nh√† Chung C∆∞ (F1.3) <span class="info-icon" onclick='openDocViewer([{page:146, label:"B·∫£ng H.1 - Nh√† ·ªü v√† KTX", highlights:["F1.3", "Nh√† ·ªü"]}])'>i</span></div>
             <table class="lookup-table">
                <thead><tr><th>B·∫≠c ch·ªãu l·ª≠a</th><th>Chi·ªÅu cao t·ªëi ƒëa</th><th>Di·ªán t√≠ch khoang ch√°y max</th></tr></thead>
                <tbody>
                    <tr><td>B·∫≠c I</td><td>‚â§ 75 m</td><td>2.500 m¬≤</td></tr>
                    <tr><td>B·∫≠c II</td><td>‚â§ 50 m</td><td>2.500 m¬≤</td></tr>
                    <tr><td>B·∫≠c III</td><td>‚â§ 28 m</td><td>1.800 m¬≤</td></tr>
                </tbody>
            </table>
            
            <div class="form-section-title" style="margin-top:20px">2. ƒê·ªëi v·ªõi Nh√† C√¥ng C·ªông (F3, F4...) <span class="info-icon" onclick='openDocViewer([{page:147, label:"B·∫£ng H.2 - Nh√† c√¥ng c·ªông", highlights:["Nh√† c√¥ng c·ªông"]}])'>i</span></div>
             <table class="lookup-table">
                <thead><tr><th>B·∫≠c ch·ªãu l·ª≠a</th><th>Chi·ªÅu cao t·ªëi ƒëa</th><th>Di·ªán t√≠ch khoang ch√°y max (1 t·∫ßng)</th></tr></thead>
                <tbody>
                    <tr><td>B·∫≠c I</td><td>‚â§ 50 m</td><td>6.000 m¬≤</td></tr>
                    <tr><td>B·∫≠c II</td><td>‚â§ 50 m</td><td>6.000 m¬≤</td></tr>
                    <tr><td>B·∫≠c III</td><td>‚â§ 15 m</td><td>3.000 m¬≤</td></tr>
                    <tr><td>B·∫≠c IV</td><td>‚â§ 9 m</td><td>2.000 m¬≤</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- TRA C·ª®U C·∫§U KI·ªÜN -->
    <div id="cau-kien" class="section">
        <h2 style="margin-top:0">B·∫£ng 1: Gi·ªõi h·∫°n ch·ªãu l·ª≠a c·ªßa c·∫•u ki·ªán (REI)</h2>
        <div class="card">
            <table class="lookup-table">
                <thead>
                    <tr>
                        <th rowspan="2">B·ªô ph·∫≠n nh√† <span class="info-icon" onclick='openDocViewer([{pages:[26,27], label:"B·∫£ng 4 - Gi·ªõi h·∫°n ch·ªãu l·ª≠a c·ªßa c·∫•u ki·ªán", highlights:["B·ªô ph·∫≠n ch·ªãu l·ª±c"]}])'>i</span></th>
                        <th colspan="4" style="text-align:center">B·∫≠c ch·ªãu l·ª≠a c·ªßa nh√†</th>
                    </tr>
                    <tr>
                        <th>B·∫≠c I</th>
                        <th>B·∫≠c II</th>
                        <th>B·∫≠c III</th>
                        <th>B·∫≠c IV</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td><strong>B·ªô ph·∫≠n ch·ªãu l·ª±c</strong> (C·ªôt, D·∫ßm, T∆∞·ªùng)</td><td>R 120</td><td>R 90</td><td>R 45</td><td>R 15</td></tr>
                    <tr><td><strong>T∆∞·ªùng ngo√†i</strong> (Kh√¥ng ch·ªãu l·ª±c)</td><td>E 30</td><td>E 15</td><td>E 15</td><td>E 15</td></tr>
                    <tr><td><strong>S√†n t·∫ßng</strong> (Gi·ªØa c√°c t·∫ßng)</td><td>REI 60</td><td>REI 45</td><td>REI 45</td><td>REI 15</td></tr>
                    <tr><td><strong>M√°i</strong> (Kh√¥ng c√≥ t·∫ßng √°p m√°i)</td><td>RE 30</td><td>RE 15</td><td>RE 15</td><td>RE 15</td></tr>
                    <tr><td><strong>T∆∞·ªùng bu·ªìng thang b·ªô</strong></td><td>REI 120</td><td>REI 90</td><td>REI 60</td><td>REI 45</td></tr>
                </tbody>
            </table>
            <div style="margin-top:10px; font-style:italic; font-size:12px; color:#666">* R: M·∫•t kh·∫£ nƒÉng ch·ªãu l·ª±c | E: M·∫•t t√≠nh to√†n v·∫πn | I: M·∫•t t√≠nh c√°ch nhi·ªát</div>
        </div>
    </div>

    <!-- TRA C·ª®U THO√ÅT N·∫†N -->
    <div id="thoat-nan" class="section">
        <h2 style="margin-top:0">Tra c·ª©u s·ªë li·ªáu Tho√°t n·∫°n</h2>
        <div class="card">
            <div class="form-section-title">1. Chi·ªÅu r·ªông l·ªëi tho√°t n·∫°n t·ªëi thi·ªÉu (m) <span class="info-icon" onclick='openDocViewer([{page:39, label:"M·ª•c 3.2.9 - K√≠ch th∆∞·ªõc l·ªëi ra tho√°t n·∫°n", highlights:["1,2 m", "0,8 m"]}])'>i</span></div>
            <table class="lookup-table">
                <thead><tr><th>ƒê·ªëi t∆∞·ª£ng</th><th>S·ªë ng∆∞·ªùi</th><th>K√≠ch th∆∞·ªõc min</th></tr></thead>
                <tbody>
                    <tr><td>H√†nh lang, v·∫ø thang (F1.1)</td><td>> 15 ng∆∞·ªùi</td><td>1.2 m</td></tr>
                    <tr><td>H√†nh lang, v·∫ø thang (Kh√°c)</td><td>> 50 ng∆∞·ªùi</td><td>1.2 m</td></tr>
                    <tr><td>C·ª≠a ƒëi</td><td>-</td><td>0.8 m</td></tr>
                    <tr><td>C√°c l·ªëi ƒëi kh√°c</td><td>-</td><td>1.0 m</td></tr>
                </tbody>
            </table>

            <div class="form-section-title" style="margin-top:20px">2. Kho·∫£ng c√°ch gi·ªõi h·∫°n cho ph√©p (m) <span class="info-icon" onclick='openDocViewer([{page:137, label:"B·∫£ng G.1 (Nh√† ·ªü)", highlights:["Kho·∫£ng c√°ch gi·ªõi h·∫°n"]}])'>i</span></div>
            <div style="font-size:13px; color:#444; margin-bottom:10px">T·ª´ c·ª≠a cƒÉn h·ªô ƒë·∫øn l·ªëi ra tho√°t n·∫°n g·∫ßn nh·∫•t (Nh√† F1.3 - B·∫≠c I, II):</div>
            <table class="lookup-table">
                <thead><tr><th>V·ªã tr√≠ c·ª≠a</th><th>Kho·∫£ng c√°ch max</th></tr></thead>
                <tbody>
                    <tr><td>Gi·ªØa c√°c bu·ªìng thang b·ªô</td><td>40 m</td></tr>
                    <tr><td>H√†nh lang c·ª•t</td><td>25 m</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- TRA C·ª®U ƒê∆Ø·ªúNG XE -->
    <div id="duong-xe" class="section">
        <h2 style="margin-top:0">Tra c·ª©u B√£i ƒë·ªó & ƒê∆∞·ªùng cho xe ch·ªØa ch√°y</h2>
        <div class="card">
            <!-- Simple Checker -->
            <div class="form-section-title">Ki·ªÉm tra nhanh k√≠ch th∆∞·ªõc</div>
            <div class="form-grid">
                <div class="input-group">
                    <label>Chi·ªÅu r·ªông m·∫∑t ƒë∆∞·ªùng (m):
                        <span class="info-icon" onclick='openDocViewer([{page:74, label:"M·ª•c 6.2.1.1 - Chi·ªÅu r·ªông ƒë∆∞·ªùng", highlights:["3,5 m"]}])'>i</span>
                    </label>
                    <input type="number" id="check-road-width" placeholder="VD: 4.0">
                </div>
                <div class="input-group">
                    <label>Chi·ªÅu cao th√¥ng th·ªßy (m):
                        <span class="info-icon" onclick='openDocViewer([{page:75, label:"M·ª•c 6.2.1.3 - Chi·ªÅu cao th√¥ng th·ªßy", highlights:["4,5 m"]}])'>i</span>
                    </label>
                    <input type="number" id="check-road-height" placeholder="VD: 5.0">
                </div>
            </div>
            <button class="btn" onclick="checkRoadAccess()">KI·ªÇM TRA</button>
            <div id="road-result" style="margin-top:10px; display:none" class="calc-box"></div>
        </div>

        <div class="card">
            <div class="form-section-title">Quy ƒë·ªãnh chung (QCVN 06:2022 - M·ª•c 6.2)</div>
            <table class="lookup-table">
                <thead><tr><th>Th√¥ng s·ªë</th><th>Y√™u c·∫ßu t·ªëi thi·ªÉu</th><th>CƒÉn c·ª©</th></tr></thead>
                <tbody>
                    <tr><td>Chi·ªÅu r·ªông m·∫∑t ƒë∆∞·ªùng</td><td><strong>3.5 m</strong></td><td>M·ª•c 6.2.1.1</td></tr>
                    <tr><td>Chi·ªÅu cao th√¥ng th·ªßy</td><td><strong>4.5 m</strong></td><td>M·ª•c 6.2.1.3</td></tr>
                    <tr><td>B√£i quay xe (ƒë∆∞·ªùng c·ª•t > 46m)</td><td>12 x 12 m</td><td>M·ª•c 6.2.5 <span class="info-icon" onclick='openDocViewer([{page:79, label:"M·ª•c 6.4 - B√£i quay xe", highlights:["12 m x 12 m"]}])'>i</span></td></tr>
                </tbody>
            </table>
        </div>

         <div class="card">
            <div class="form-section-title">B√£i ƒë·ªó xe ch·ªØa ch√°y (B·∫£ng 14) <span class="info-icon" onclick='openDocViewer([{page:75, label:"B·∫£ng 14 - K√≠ch th∆∞·ªõc b√£i ƒë·ªó", highlights:["B√£i ƒë·ªó xe ch·ªØa ch√°y"]}])'>i</span></div>
            <table class="lookup-table">
                <thead><tr><th>Nh√≥m nh√†</th><th>Chi·ªÅu cao PCCC</th><th>R·ªông x D√†i (min)</th></tr></thead>
                <tbody>
                    <tr><td>F1.3 (Chung c∆∞)</td><td>> 15 m</td><td>6 m x 15 m</td></tr>
                    <tr><td>C√°c nh√≥m kh√°c</td><td>> 15 m</td><td>6 m x 15 m</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- DOCUMENT VIEWER MODAL -->
<div id="doc-modal" class="doc-modal-overlay">
    <div class="doc-modal">
        <div class="doc-header">
            <div class="doc-title">üìÑ QCVN 06:2022/BXD - TR√åNH XEM CƒÇN C·ª® PH√ÅP L√ù</div>
            <button class="close-btn" onclick="closeDocViewer()">‚úï</button>
        </div>
        <div class="doc-body" id="doc-viewer-content">
            <!-- Pages will be injected here -->
        </div>
    </div>
</div>

<!-- JAVASCRIPT -->
<script>
    // --- DATABASE VƒÇN B·∫¢N G·ªêC T·ª™ PDF ƒê√É C·∫¨P NH·∫¨T ƒê·∫¶Y ƒê·ª¶ B·∫¢NG ---
    const qcvnPages = {
        // --- ƒê·ªäNH NGHƒ®A QUY M√î ---
        8: `<h4 style="text-align:center">QCVN 06:2022/BXD</h4><p><strong>1.4.9. Chi·ªÅu cao ph√≤ng ch√°y ch·ªØa ch√°y (chi·ªÅu cao PCCC)</strong></p><p>Chi·ªÅu cao PCCC c·ªßa nh√† (kh√¥ng t√≠nh t·∫ßng k·ªπ thu·∫≠t tr√™n c√πng) ƒë∆∞·ª£c x√°c ƒë·ªãnh nh∆∞ sau:</p><ul style="list-style-type: disc; margin-left: 20px;"><li>B·∫±ng kho·∫£ng c√°ch l·ªõn nh·∫•t t√≠nh t·ª´ m·∫∑t ƒë∆∞·ªùng cho xe ch·ªØa ch√°y ti·∫øp c·∫≠n ƒë·∫øn m√©p d∆∞·ªõi c·ªßa l·ªó c·ª≠a (c·ª≠a s·ªï) m·ªü tr√™n t∆∞·ªùng ngo√†i c·ªßa t·∫ßng tr√™n c√πng;</li><li>B·∫±ng m·ªôt n·ª≠a t·ªïng kho·∫£ng c√°ch t√≠nh t·ª´ m·∫∑t ƒë∆∞·ªùng cho xe ch·ªØa ch√°y ti·∫øp c·∫≠n ƒë·∫øn m·∫∑t s√†n v√† ƒë·∫øn tr·∫ßn c·ªßa t·∫ßng tr√™n c√πng ‚Äì khi kh√¥ng c√≥ l·ªó c·ª≠a (c·ª≠a s·ªï).</li></ul><p><em>CH√ö TH√çCH 1: Khi m√°i nh√† ƒë∆∞·ª£c khai th√°c s·ª≠ d·ª•ng th√¨ chi·ªÅu cao PCCC c·ªßa nh√† ƒë∆∞·ª£c x√°c ƒë·ªãnh b·∫±ng kho·∫£ng c√°ch l·ªõn nh·∫•t t·ª´ m·∫∑t ƒë∆∞·ªùng cho xe ch·ªØa ch√°y ti·∫øp c·∫≠n ƒë·∫øn m√©p tr√™n t∆∞·ªùng bao c·ªßa m√°i.</em></p>`,
        13: `<h4 style="text-align:center">QCVN 06:2022/BXD</h4><p><strong>1.4.47. Quy m√¥ kh·ªëi t√≠ch</strong></p><p>Kh·ªëi t√≠ch c·ªßa m·ªôt kh√¥ng gian trong ph·∫°m vi m·ªôt nh√† ho·∫∑c khoang ch√°y. Kh·ªëi t√≠ch n√†y kh√¥ng bao g·ªìm c√°c t∆∞·ªùng c·ªßa thang m√°y ƒë∆∞·ª£c b·∫£o v·ªá, bu·ªìng thang b·ªô tho√°t n·∫°n v√† c√°c kh√¥ng gian kh√°c (v√≠ d·ª•: khu v·ªá sinh v√† c√°c bu·ªìng ƒë·ªÉ ƒë·ªì) ƒë∆∞·ª£c bao che b·∫±ng c√°c t∆∞·ªùng c√≥ gi·ªõi h·∫°n ch·ªãu l·ª≠a kh√¥ng th·∫•p h∆°n 60 ph√∫t, ƒë·ªìng th·ªùi c√°c l·ªëi ƒëi qua t∆∞·ªùng ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng c·ª≠a ngƒÉn ch√°y lo·∫°i 2 c√≥ l·∫Øp c∆° c·∫•u t·ª± ƒë√≥ng. Quy m√¥ kh·ªëi t√≠ch ƒë∆∞·ª£c t√≠nh d·ª±a v√†o c√°c k√≠ch th∆∞·ªõc sau:</p><p>a) K√≠ch th∆∞·ªõc m·∫∑t b·∫±ng l·∫•y theo kho·∫£ng c√°ch gi·ªØa c√°c b·ªÅ m·∫∑t ho√†n thi·ªán ph√≠a trong c·ªßa t∆∞·ªùng bao, ho·∫∑c ·ªü t·∫•t c·∫£ c√°c m·∫∑t kh√¥ng c√≥ t∆∞·ªùng bao th√¨ t√≠nh ƒë·∫øn m·ªôt m·∫∑t ph·∫≥ng th·∫≥ng ƒë·ª©ng k√©o ƒë·∫øn c·∫°nh ngo√†i tr√™n c√πng c·ªßa s√†n;</p><p>b) Chi·ªÅu cao l·∫•y theo kho·∫£ng c√°ch t·ª´ b·ªÅ m·∫∑t tr√™n c·ªßa s√†n ph√≠a d∆∞·ªõi ƒë·∫øn m·∫∑t b·ªÅ m·∫∑t d∆∞·ªõi c·ªßa s√†n ph√≠a tr√™n c·ªßa kh√¥ng gian;</p>`,
        14: `<h4 style="text-align:center">QCVN 06:2022/BXD</h4><p><strong>1.4.50. S·ªë t·∫ßng nh√†</strong></p><p>S·ªë t·∫ßng c·ªßa t√≤a nh√† bao g·ªìm to√†n b·ªô c√°c t·∫ßng tr√™n m·∫∑t ƒë·∫•t (k·ªÉ c·∫£ t·∫ßng k·ªπ thu·∫≠t, t·∫ßng tum) v√† t·∫ßng b√°n/n·ª≠a h·∫ßm, kh√¥ng bao g·ªìm t·∫ßng √°p m√°i.</p><p><em>CH√ö TH√çCH: T·∫ßng tum kh√¥ng t√≠nh v√†o s·ªë t·∫ßng nh√† c·ªßa c√¥ng tr√¨nh khi ch·ªâ c√≥ ch·ª©c nƒÉng s·ª≠ d·ª•ng ƒë·ªÉ bao che l·ªìng c·∫ßu thang b·ªô gi·∫øng thang m√°y v√† che ch·∫Øn c√°c thi·∫øt b·ªã k·ªπ thu·∫≠t c·ªßa c√¥ng tr√¨nh (n·∫øu c√≥), c√≥ di·ªán t√≠ch m√°i tum kh√¥ng v∆∞·ª£t qu√° 30% di·ªán t√≠ch s√†n m√°i.</em></p><p><strong>1.4.15. Di·ªán t√≠ch s√†n d√πng ƒë·ªÉ t√≠nh to√°n</strong></p><p>Di·ªán t√≠ch m·∫∑t s√†n c·ªßa t·∫•t c·∫£ c√°c khu v·ª±c ƒë∆∞·ª£c bao che trong m·ªôt nh√† ho·∫∑c ph·∫ßn nh√†, bao g·ªìm c·∫£ di·ªán t√≠ch c√°c k√™nh d·∫´n, s√†n gi·∫øng thang m√°y, nh√† v·ªá sinh, bu·ªìng thang b·ªô, di·ªán t√≠ch chi·∫øm ch·ªó b·ªüi ƒë·ªì d√πng, m√°y m√≥c, thi·∫øt b·ªã c·ªë ƒë·ªãnh ho·∫∑c di ƒë·ªông v√† c·∫£ c√°c di·ªán t√≠ch sinh ho·∫°t h·ªü ngo√†i tr·ªùi ·ªü ph√≠a tr√™n ho·∫∑c ph√≠a d∆∞·ªõi t·∫ßng 1 c·ªßa nh√†.</p>`,
        
        // --- PH√ÇN LO·∫†I C√îNG TR√åNH (B·∫£ng 6) ---
        29: `<h4 style="text-align:center">B·∫£ng 6 ‚Äì Ph√¢n nh√≥m nh√† d·ª±a tr√™n t√≠nh nguy hi·ªÉm ch√°y theo c√¥ng nƒÉng</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Nh√≥m</th><th>M·ª•c ƒë√≠ch s·ª≠ d·ª•ng</th><th>ƒê·∫∑c ƒëi·ªÉm s·ª≠ d·ª•ng</th></tr><tr><td>F1.1</td><td>Nh√† tr·∫ª, tr∆∞·ªùng m·∫´u gi√°o, m·∫ßm non; b·ªánh vi·ªán...</td><td>S·ª≠ d·ª•ng c·∫£ ng√†y v√† ƒë√™m...</td></tr><tr><td>F1.2</td><td>Kh√°ch s·∫°n, k√Ω t√∫c x√°...</td><td></td></tr><tr><td>F1.3</td><td>Nh√† chung c∆∞...</td><td></td></tr><tr><td>F4.3</td><td>Tr·ª• s·ªü c∆° quan, vƒÉn ph√≤ng, ng√¢n h√†ng...</td><td>C√≥ nh√≥m ng∆∞·ªùi l√†m vi·ªác c·ªë ƒë·ªãnh...</td></tr><tr><td>F5.1</td><td>Nh√† s·∫£n xu·∫•t, x∆∞·ªüng...</td><td></td></tr><tr><td>F5.2</td><td>Nh√† kho, gara xe...</td><td></td></tr></table>`,
        30: `<h4 style="text-align:center">B·∫£ng 6 (ti·∫øp theo)</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Nh√≥m</th><th>M·ª•c ƒë√≠ch s·ª≠ d·ª•ng</th></tr><tr><td>F2.1</td><td>Nh√† h√°t, r·∫°p chi·∫øu phim, r·∫°p xi·∫øc...</td></tr><tr><td>F2.2</td><td>B·∫£o t√†ng, tri·ªÉn l√£m...</td></tr><tr><td>F2.3</td><td>Nh√† h√°t, r·∫°p chi·∫øu phim ngo√†i tr·ªùi...</td></tr><tr><td>F3.1</td><td>C∆° s·ªü th∆∞∆°ng m·∫°i, si√™u th·ªã...</td></tr><tr><td>F3.2</td><td>C∆° s·ªü ƒÉn u·ªëng...</td></tr><tr><td>F3.3</td><td>Nh√† ga...</td></tr><tr><td>F3.4</td><td>Ph√≤ng kh√°m ƒëa khoa...</td></tr><tr><td>F3.5</td><td>C∆° s·ªü d·ªãch v·ª• ƒë·ªùi s·ªëng...</td></tr></table>`,
        31: `<h4 style="text-align:center">B·∫£ng 6 (k·∫øt th√∫c)</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Nh√≥m</th><th>M·ª•c ƒë√≠ch s·ª≠ d·ª•ng</th></tr><tr><td>F4.1</td><td>Tr∆∞·ªùng h·ªçc, c∆° s·ªü gi√°o d·ª•c...</td></tr><tr><td>F4.2</td><td>Tr∆∞·ªùng ƒë·∫°i h·ªçc, cao ƒë·∫≥ng...</td></tr><tr><td>F5.3</td><td>Nh√† ph·ª•c v·ª• n√¥ng nghi·ªáp...</td></tr></table>`,

        // --- B·∫¨C CH·ªäU L·ª¨A (B·∫£ng 4) ---
        26: `<h4 style="text-align:center">B·∫£ng 4 ‚Äì S·ª± ph√π h·ª£p gi·ªØa b·∫≠c ch·ªãu l·ª≠a c·ªßa nh√†, c√¥ng tr√¨nh v√† khoang ch√°y v·ªõi gi·ªõi h·∫°n ch·ªãu l·ª≠a c·ªßa c·∫•u ki·ªán x√¢y d·ª±ng</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th rowspan="2">B·∫≠c ch·ªãu l·ª≠a</th><th colspan="5">Gi·ªõi h·∫°n ch·ªãu l·ª≠a c·ªßa c·∫•u ki·ªán, kh√¥ng nh·ªè h∆°n (ph√∫t)</th></tr><tr><th>T∆∞·ªùng/C·ªôt ch·ªãu l·ª±c (R)</th><th>S√†n t·∫ßng (REI)</th><th>T∆∞·ªùng ngo√†i (E)</th><th>M√°i (R/RE)</th><th>T∆∞·ªùng bu·ªìng thang (REI)</th></tr><tr><td>I</td><td>R 120</td><td>REI 60</td><td>E 30</td><td>REI 30</td><td>REI 120</td></tr><tr><td>II</td><td>R 90</td><td>REI 45</td><td>E 15</td><td>REI 15</td><td>REI 90</td></tr><tr><td>III</td><td>R 45</td><td>REI 45</td><td>E 15</td><td>REI 15</td><td>REI 60</td></tr><tr><td>IV</td><td>R 15</td><td>REI 15</td><td>E 15</td><td>REI 15</td><td>REI 45</td></tr><tr><td>V</td><td colspan="5">Kh√¥ng quy ƒë·ªãnh</td></tr></table>`,
        27: `<h4 style="text-align:center">Ghi ch√∫ B·∫£ng 4</h4><p>CH√ö TH√çCH 1: Trong c√°c nh√† c√≥ b·∫≠c ch·ªãu l·ª≠a I, II, III th√¨ s√†n v√† tr·∫ßn c·ªßa t·∫ßng h·∫ßm, t·∫ßng n·ª≠a h·∫ßm ph·∫£i l√†m b·∫±ng v·∫≠t li·ªáu kh√¥ng ch√°y v√† c√≥ gi·ªõi h·∫°n ch·ªãu l·ª≠a √≠t nh·∫•t REI 90. S√†n t·∫ßng 1 v√† t·∫ßng tr√™n c√πng ph·∫£i l√†m b·∫±ng v·∫≠t li·ªáu c√≥ t√≠nh ch√°y kh√¥ng th·∫•p h∆°n Ch1...</p><p>CH√ö TH√çCH 2: Kh√¥ng quy ƒë·ªãnh gi·ªõi h·∫°n ch·ªãu l·ª≠a c·ªßa c√°c t·∫•m l·ª£p... n·∫øu ch√∫ng ƒë∆∞·ª£c l√†m t·ª´ v·∫≠t li·ªáu kh√¥ng ch√°y, ho·∫∑c ch√°y y·∫øu...</p>`,

        // --- THO√ÅT N·∫†N ---
        38: `<h4 style="text-align:center">3.2.4. S·ªë l∆∞·ª£ng v√† chi·ªÅu r·ªông l·ªëi ra tho√°t n·∫°n</h4><p>S·ªë l∆∞·ª£ng v√† chi·ªÅu r·ªông c·ªßa c√°c l·ªëi ra tho√°t n·∫°n t·ª´ c√°c gian ph√≤ng, c√°c t·∫ßng v√† c√°c nh√† ƒë∆∞·ª£c x√°c ƒë·ªãnh theo s·ªë l∆∞·ª£ng ng∆∞·ªùi tho√°t n·∫°n l·ªõn nh·∫•t c√≥ th·ªÉ ƒëi qua ch√∫ng v√† kho·∫£ng c√°ch gi·ªõi h·∫°n cho ph√©p t·ª´ ch·ªó xa nh·∫•t c√≥ th·ªÉ c√≥ ng∆∞·ªùi (sinh ho·∫°t, l√†m vi·ªác) t·ªõi l·ªëi ra tho√°t n·∫°n g·∫ßn nh·∫•t.</p>`,
        39: `<h4 style="text-align:center">3.2.9. K√≠ch th∆∞·ªõc l·ªëi ra tho√°t n·∫°n</h4><p>Chi·ªÅu cao th√¥ng thu·ª∑ c·ªßa l·ªëi ra tho√°t n·∫°n ph·∫£i kh√¥ng nh·ªè h∆°n 1,9 m, chi·ªÅu r·ªông th√¥ng th·ªßy kh√¥ng nh·ªè h∆°n:</p><ul><li>1,2 m ‚Äì t·ª´ c√°c gian ph√≤ng nh√≥m F1.1 khi s·ªë ng∆∞·ªùi tho√°t n·∫°n l·ªõn h∆°n 15 ng∆∞·ªùi, t·ª´ c√°c gian ph√≤ng v√† nh√† thu·ªôc nh√≥m nguy hi·ªÉm ch√°y theo c√¥ng nƒÉng kh√°c c√≥ s·ªë ng∆∞·ªùi tho√°t n·∫°n l·ªõn h∆°n 50 ng∆∞·ªùi, ngo·∫°i tr·ª´ nh√≥m F1.3;</li><li>0,8 m ‚Äì trong t·∫•t c·∫£ c√°c tr∆∞·ªùng h·ª£p c√≤n l·∫°i.</li></ul>`,
        
        // --- ƒê∆Ø·ªúNG XE CH·ªÆA CH√ÅY ---
        74: `<h4 style="text-align:center">6.2. ƒê∆∞·ªùng cho xe ch·ªØa ch√°y v√† b√£i ƒë·ªó xe ch·ªØa ch√°y</h4><p><strong>6.2.1.1.</strong> Chi·ªÅu r·ªông th√¥ng th·ªßy c·ªßa m·∫∑t ƒë∆∞·ªùng cho xe ch·ªØa ch√°y kh√¥ng ƒë∆∞·ª£c nh·ªè h∆°n 3,5 m.</p>`,
        75: `<h4 style="text-align:center">B·∫£ng 14 - K√≠ch th∆∞·ªõc b√£i ƒë·ªó xe ch·ªØa ch√°y</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Nh√≥m nh√†</th><th>Chi·ªÅu cao PCCC <= 15m</th><th>> 15m v√† <= 28m</th><th>> 28m</th></tr><tr><td>1. Nh√† F1.3</td><td>Kh√¥ng y√™u c·∫ßu</td><td>R·ªông >= 6m; D√†i >= 15m</td><td>R·ªông >= 6m; D√†i >= 15m</td></tr><tr><td>2. C√°c nh√≥m kh√°c</td><td>Kh√¥ng y√™u c·∫ßu</td><td>R·ªông >= 6m; D√†i theo B·∫£ng 15,16</td><td>R·ªông >= 6m; D√†i theo B·∫£ng 15,16</td></tr></table><p><strong>6.2.1.3.</strong> Chi·ªÅu cao th√¥ng th·ªßy ƒë·ªÉ c√°c ph∆∞∆°ng ti·ªán ch·ªØa ch√°y ƒëi qua kh√¥ng ƒë∆∞·ª£c nh·ªè h∆°n 4,5 m.</p>`,
        79: `<h4 style="text-align:center">6.4. B√£i quay xe</h4><p>Thi·∫øt k·∫ø b√£i quay xe ph·∫£i ph√π h·ª£p v·ªõi ph∆∞∆°ng ti·ªán ch·ªØa ch√°y ·ªü ƒë·ªãa ph∆∞∆°ng. (M·ª•c 6.2.5: N·∫øu chi·ªÅu d√†i c·ªßa ƒë∆∞·ªùng cho xe ch·ªØa ch√°y ho·∫∑c b√£i ƒë·ªó xe ch·ªØa ch√°y d·∫°ng c·ª•t l·ªõn h∆°n 46 m th√¨ ·ªü cu·ªëi ƒëo·∫°n c·ª•t ph·∫£i c√≥ b√£i quay xe ƒë∆∞·ª£c thi·∫øt k·∫ø theo quy ƒë·ªãnh t·∫°i 6.4).</p>`,

        // --- DI·ªÜN T√çCH KHOANG CH√ÅY (PH·ª§ L·ª§C H) ---
        146: `<h4 style="text-align:center">PH·ª§ L·ª§C H - B·∫£ng H.1 ‚Äì Nh√† ·ªü v√† k√Ω t√∫c x√° ki·ªÉu cƒÉn h·ªô</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>B·∫≠c ch·ªãu l·ª≠a</th><th>C·∫•p nguy hi·ªÉm ch√°y KC</th><th>Chi·ªÅu cao PCCC max (m)</th><th>Di·ªán t√≠ch khoang ch√°y max (m2)</th></tr><tr><td>I</td><td>S0</td><td>75</td><td>2 500</td></tr><tr><td>II</td><td>S0</td><td>50</td><td>2 500</td></tr><tr><td>II</td><td>S1</td><td>28</td><td>2 200</td></tr><tr><td>III</td><td>S0</td><td>28</td><td>1 800</td></tr><tr><td>IV</td><td>S0</td><td>5</td><td>1 000</td></tr></table>`,
        147: `<h4 style="text-align:center">PH·ª§ L·ª§C H - B·∫£ng H.2 ‚Äì Nh√† c√¥ng c·ªông</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th rowspan="2">B·∫≠c ch·ªãu l·ª≠a</th><th rowspan="2">C·∫•p nguy hi·ªÉm ch√°y KC</th><th rowspan="2">Chi·ªÅu cao PCCC max (m)</th><th colspan="3">Di·ªán t√≠ch khoang ch√°y max (m2) theo s·ªë t·∫ßng</th></tr><tr><th>1 t·∫ßng</th><th>2 t·∫ßng</th><th>3 t·∫ßng</th></tr><tr><td>I</td><td>S0</td><td>50</td><td>6 000</td><td>5 000</td><td>5 000</td></tr><tr><td>II</td><td>S0</td><td>50</td><td>6 000</td><td>4 000</td><td>4 000</td></tr><tr><td>III</td><td>S0</td><td>15</td><td>3 000</td><td>2 000</td><td>2 000</td></tr></table>`,
        161: `<h4 style="text-align:center">H.6. T√≠nh di·ªán t√≠ch khoang ch√°y</h4><p>H.6.2. Di·ªán t√≠ch khoang ch√°y l√† di·ªán t√≠ch l·ªõn nh·∫•t c·ªßa m·ªôt t·∫ßng trong ph·∫°m vi m·ªôt khoang ch√°y. Di·ªán t√≠ch m·ªôt t·∫ßng trong ph·∫°m vi m·ªôt khoang ch√°y l√† di·ªán t√≠ch t·∫ßng ƒë∆∞·ª£c gi·ªõi h·∫°n b·ªüi c√°c t∆∞·ªùng bao c·ªßa nh√† v√† (ho·∫∑c) c√°c t∆∞·ªùng ngƒÉn ch√°y lo·∫°i 1.</p>`,

        // --- C·∫§P N∆Ø·ªöC CH·ªÆA CH√ÅY (B·∫£ng 11) ---
        67: `<h4 style="text-align:center">B·∫£ng 11 ‚Äì S·ªë tia phun ch·ªØa ch√°y v√† l∆∞u l∆∞·ª£ng n∆∞·ªõc t·ªëi thi·ªÉu ƒë·ªëi v·ªõi h·ªá th·ªëng h·ªçng n∆∞·ªõc ch·ªØa ch√°y trong nh√†</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Lo·∫°i nh√†</th><th>S·ªë tia phun</th><th>L∆∞u l∆∞·ª£ng/1 tia (L/s)</th></tr><tr><td>1. Nh√† ·ªü, chung c∆∞ (<= 16 t·∫ßng, h√†nh lang <= 10m)</td><td>1</td><td>2,5</td></tr><tr><td>1. Nh√† ·ªü, chung c∆∞ (> 16 t·∫ßng)</td><td>2 ho·∫∑c 3</td><td>2,5</td></tr><tr><td>2. Nh√† h√†nh ch√≠nh (<= 10 t·∫ßng, V <= 25.000 m3)</td><td>1</td><td>2,5</td></tr></table>`,

        // --- C√ÅC PH·ª§ L·ª§C KH√ÅC ---
        105: `<h4 style="text-align:center">PH·ª§ L·ª§C C - B·∫£ng C.1 ‚àí H·∫°ng nguy hi·ªÉm ch√°y v√† ch√°y n·ªï c·ªßa gian ph√≤ng</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>H·∫°ng</th><th>ƒê·∫∑c ƒëi·ªÉm ch·∫•t v√† v·∫≠t li·ªáu</th></tr><tr><td>A</td><td>Ch·∫•t kh√≠ ch√°y, l·ªèng d·ªÖ b·∫Øt ch√°y (t <= 28 ƒë·ªô C)...</td></tr><tr><td>B</td><td>B·ª•i, s·ª£i ch√°y, l·ªèng d·ªÖ b·∫Øt ch√°y (t > 28 ƒë·ªô C)...</td></tr><tr><td>C1-C4</td><td>Ch·∫•t l·ªèng ch√°y, kh√≥ ch√°y, ch·∫•t r·∫Øn ch√°y (k·ªÉ c·∫£ b·ª•i, s·ª£i)...</td></tr><tr><td>D</td><td>Ch·∫•t v√† v·∫≠t li·ªáu kh√¥ng ch√°y ·ªü tr·∫°ng th√°i n√≥ng...</td></tr><tr><td>E</td><td>Ch·∫•t v√† v·∫≠t li·ªáu kh√¥ng ch√°y ·ªü tr·∫°ng th√°i ngu·ªôi.</td></tr></table>`,
        119: `<h4 style="text-align:center">PH·ª§ L·ª§C E - B·∫£ng E.1 ‚àí Kho·∫£ng c√°ch ph√≤ng ch√°y ch·ªëng ch√°y</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>B·∫≠c ch·ªãu l·ª≠a nh√† 1</th><th>ƒê·∫øn nh√† B·∫≠c I, II, III (S0)</th><th>ƒê·∫øn nh√† B·∫≠c IV (S0, S1)</th><th>ƒê·∫øn nh√† B·∫≠c IV, V (S2, S3)</th></tr><tr><td>I, II, III (S0)</td><td>6 m</td><td>8 m</td><td>10 m</td></tr><tr><td>II, III (S1)</td><td>8 m</td><td>10 m</td><td>12 m</td></tr><tr><td>IV (S0, S1)</td><td>8 m</td><td>10 m</td><td>12 m</td></tr><tr><td>IV, V (S2, S3)</td><td>10 m</td><td>12 m</td><td>15 m</td></tr></table>`,
        120: `<h4 style="text-align:center">B·∫£ng E.2 ‚àí Kho·∫£ng c√°ch ph√≤ng ch√°y ch·ªëng ch√°y gi·ªØa c√°c nh√† trong m·ªôt c∆° s·ªü c√¥ng nghi·ªáp</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>B·∫≠c ch·ªãu l·ª≠a</th><th>ƒê·∫øn nh√† B·∫≠c I, II</th><th>ƒê·∫øn nh√† B·∫≠c IV</th></tr><tr><td>I, II</td><td>9 m</td><td>12 m</td></tr><tr><td>IV</td><td>12 m</td><td>15 m</td></tr></table>`,
        137: `<h4 style="text-align:center">PH·ª§ L·ª§C G - B·∫£ng G.1 ‚Äì Kho·∫£ng c√°ch gi·ªõi h·∫°n cho ph√©p (Nh√† ·ªü)</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>B·∫≠c ch·ªãu l·ª≠a</th><th>C·ª≠a gi·ªØa c√°c thang/l·ªëi ra ngo√†i</th><th>C·ª≠a h√†nh lang c·ª•t</th></tr><tr><td>I, II (S0)</td><td>40 m</td><td>25 m</td></tr><tr><td>III (S0)</td><td>30 m</td><td>20 m</td></tr><tr><td>IV (S0)</td><td>25 m</td><td>15 m</td></tr><tr><td>V</td><td>20 m</td><td>10 m</td></tr></table>`,
        138: `<h4 style="text-align:center">B·∫£ng G.2a ‚àí Kho·∫£ng c√°ch gi·ªõi h·∫°n... ƒë·ªëi v·ªõi nh√† c√¥ng c·ªông</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>B·∫≠c ch·ªãu l·ª≠a</th><th>Gi·ªØa c√°c thang (m)</th><th>H√†nh lang c·ª•t (m)</th></tr><tr><td>I, II, III</td><td>60</td><td>30</td></tr><tr><td>IV</td><td>40</td><td>20</td></tr><tr><td>V</td><td>30</td><td>15</td></tr></table>`,
        139: `<h4 style="text-align:center">B·∫£ng G.2b ‚àí Kho·∫£ng c√°ch gi·ªõi h·∫°n... gian ph√≤ng kh√¥ng c√≥ gh·∫ø ng·ªìi</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Gian ph√≤ng</th><th>B·∫≠c ch·ªãu l·ª≠a</th><th>V <= 5.000 m3</th><th>> 5.000 m3</th></tr><tr><td>S·∫£nh, ph√≤ng ch·ªù...</td><td>I, II</td><td>30 m</td><td>45 m</td></tr><tr><td>Ph√≤ng th∆∞∆°ng m·∫°i (l·ªëi ƒëi >= 25%)</td><td>I, II</td><td>50 m</td><td>65 m</td></tr></table>`,
        140: `<h4 style="text-align:center">B·∫£ng G.3 ‚àí Kho·∫£ng c√°ch gi·ªõi h·∫°n... nh√† s·∫£n xu·∫•t</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>H·∫°ng</th><th>B·∫≠c ch·ªãu l·ª≠a</th><th>V <= 15.000 m3</th><th>V = 30.000 m3</th></tr><tr><td>A, B</td><td>I, II, III, IV (S0)</td><td>40 m</td><td>60 m</td></tr><tr><td>C</td><td>I, II, III, IV (S0)</td><td>100 m</td><td>145 m</td></tr></table>`,
        144: `<h4 style="text-align:center">B·∫£ng G.9 ‚àí H·ªá s·ªë kh√¥ng gian s√†n</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Kh√¥ng gian s·ª≠ d·ª•ng</th><th>H·ªá s·ªë (m2/ng∆∞·ªùi)</th></tr><tr><td>1. H·ªôi tr∆∞·ªùng, n∆°i ƒë√¥ng ng∆∞·ªùi...</td><td>1,0</td></tr><tr><td>2. S·∫£nh l·ªõn, si√™u th·ªã...</td><td>3,0</td></tr><tr><td>3. Ph√≤ng h·ªçp, ph√≤ng h·ªçc...</td><td>1,5</td></tr><tr><td>8. VƒÉn ph√≤ng</td><td>6,0</td></tr><tr><td>11. Ph√≤ng ng·ªß</td><td>8,0</td></tr><tr><td>13. Kho</td><td>30,0</td></tr><tr><td>14. Nh√† ƒë·ªÉ xe √¥t√¥</td><td>2 ng∆∞·ªùi/√¥</td></tr></table>`,
        145: `<h4 style="text-align:center">B·∫£ng G.9 (k·∫øt th√∫c)</h4><p>CH√ö TH√çCH 1: N·∫øu kh√¥ng s·ª≠ d·ª•ng c√°c gi√° tr·ªã trong b·∫£ng n√†y th√¨ c√≥ th·ªÉ x√°c ƒë·ªãnh h·ªá s·ªë kh√¥ng gian s√†n theo s·ªë li·ªáu th·ª±c t·∫ø...</p>`,
        104: `<h4 style="text-align:center">B·∫£ng B.8 & B.9 - Y√™u c·∫ßu v·∫≠t li·ªáu</h4><table border="1" style="width:100%; border-collapse:collapse;"><tr><th>Khu v·ª±c</th><th>T∆∞·ªùng/Tr·∫ßn</th><th>S√†n</th></tr><tr><td>H√†nh lang, ƒë∆∞·ªùng tho√°t n·∫°n (Nh√† cao t·∫ßng)</td><td>CV0/CV1</td><td>CV2</td></tr><tr><td>Ph√≤ng chung > 300 ng∆∞·ªùi</td><td>CV1</td><td>CV2</td></tr></table>`,
        84: `<h4 style="text-align:center">Ph·ª• l·ª•c A - A.1.2. Quy ƒë·ªãnh chung (Nh√† s·∫£n xu·∫•t)</h4><p>A.1.2.1. Di·ªán t√≠ch m·ªôt t·∫ßng c·ªßa nh√† trong ph·∫°m vi m·ªôt khoang ch√°y ƒë∆∞·ª£c x√°c ƒë·ªãnh theo chu vi b√™n trong c·ªßa t∆∞·ªùng bao c·ªßa t·∫ßng, kh√¥ng t√≠nh di·ªán t√≠ch bu·ªìng thang b·ªô... Di·ªán t√≠ch x√¢y d·ª±ng ƒë∆∞·ª£c x√°c ƒë·ªãnh theo chu vi ngo√†i c·ªßa nh√† ·ªü cao ƒë·ªô ch√¢n t∆∞·ªùng, bao g·ªìm c·∫£ c√°c ph·∫ßn nh√¥ ra, ƒë∆∞·ªùng ƒëi qua d∆∞·ªõi nh√†, c√°c ph·∫ßn nh√† kh√¥ng c√≥ k·∫øt c·∫•u ngƒÉn che b√™n ngo√†i.</p>`
    };

    // --- H√ÄM LOGIC CH√çNH (GI·ªÆ NGUY√äN) ---
    function runCheckAll() {
        const inputs = {
            h: parseFloat(document.getElementById('inp-height').value) || 0,
            f: parseInt(document.getElementById('inp-floors').value) || 0,
            buildArea: parseFloat(document.getElementById('inp-build-area').value) || 0,
            floorArea: parseFloat(document.getElementById('inp-area').value) || 0,
            volume: parseFloat(document.getElementById('inp-volume').value) || 0,
            people: parseInt(document.getElementById('inp-people').value) || 0,
            func: document.getElementById('inp-function').value,
            dist: parseFloat(document.getElementById('inp-dist').value) || 0,
            nGrade: document.getElementById('inp-neighbor-grade').value
        };

        if (!inputs.func || !inputs.h) {
            alert("Vui l√≤ng nh·∫≠p C√¥ng nƒÉng v√† Chi·ªÅu cao!");
            return;
        }

        const report = document.getElementById('report-container');
        report.style.display = 'block';
        report.innerHTML = ''; 

        // 1. T√çNH B·∫¨C CH·ªäU L·ª¨A
        const autoGrade = calculateFireGrade(inputs);
        document.getElementById('auto-grade-display').textContent = `B·∫≠c ${autoGrade.grade}`;
        
        let rowsHTML = '<table class="report-table">';
        
        const addRow = (label, val, citations) => {
            let btnHTML = '';
            if(citations && citations.length > 0) {
                const citStr = JSON.stringify(citations).replace(/"/g, "&quot;");
                btnHTML = `<button class="mini-cite-btn" onclick="openDocViewer(${citStr})">üìñ Quy chu·∫©n</button>`;
            }
            rowsHTML += `<tr><td class="report-label">${label}</td><td style="text-align:right"><span class="report-val">${val}</span>${btnHTML}</td></tr>`;
        };

        addRow('Chi·ªÅu cao PCCC', `${inputs.h} m`, [{ page: 8, label: 'M·ª•c 1.4.9 - Chi·ªÅu cao PCCC', highlights: ['Chi·ªÅu cao PCCC'] }]);
        addRow('S·ªë t·∫ßng', `${inputs.f} t·∫ßng`, [{ page: 14, label: 'M·ª•c 1.4.50 - S·ªë t·∫ßng nh√†', highlights: ['S·ªë t·∫ßng nh√†'] }]);
        addRow('C√¥ng nƒÉng', inputs.func, [{ page: 146, label: 'B·∫£ng H.1 (F1.3) ho·∫∑c H.2', highlights: ['F1.3'] }]);
        
        if(inputs.floorArea > 0) {
            addRow('Di·ªán t√≠ch s√†n', `${inputs.floorArea} m¬≤`, [{ page: 161, label: 'H.6 - Di·ªán t√≠ch khoang ch√°y', highlights: ['Di·ªán t√≠ch khoang ch√°y'] }]);
        }

        addRow('B·∫≠c ch·ªãu l·ª≠a Y√™u c·∫ßu', `B·∫¨C ${autoGrade.grade}`, [
            { page: 26, label: 'B·∫£ng 4 - Gi·ªõi h·∫°n ch·ªãu l·ª≠a c·∫•u ki·ªán', highlights: [autoGrade.grade] },
            { page: 146, label: 'Ph·ª• l·ª•c H - Tra c·ª©u B·∫≠c/Chi·ªÅu cao', highlights: ['75', '50'] }
        ]);

        rowsHTML += '</table>';

        renderReportCard(report, '1. K·∫øt qu·∫£ X√°c ƒë·ªãnh B·∫≠c ch·ªãu l·ª≠a', autoGrade.status, `
            ${rowsHTML}
            <div class="calc-box">
                ‚Üí D·ª±a tr√™n Chi·ªÅu cao PCCC ${inputs.h}m v√† C√¥ng nƒÉng ${inputs.func}.<br>
                ‚Üí Tra c·ª©u B·∫£ng H.1 (cho Chung c∆∞) ho·∫∑c H.2 (cho nh√† c√¥ng c·ªông).
            </div>
        `);

        // 2. T√çNH THO√ÅT N·∫†N
        if (inputs.people > 0) {
            const egress = calculateEgress(inputs.people, inputs.func);
            let egressRows = '<table class="report-table">';
            
             const addEgressRow = (label, val, citations) => {
                let btnHTML = '';
                if(citations && citations.length > 0) {
                    const citStr = JSON.stringify(citations).replace(/"/g, "&quot;");
                    btnHTML = `<button class="mini-cite-btn" onclick="openDocViewer(${citStr})">üìñ Quy chu·∫©n</button>`;
                }
                egressRows += `<tr><td class="report-label">${label}</td><td style="text-align:right"><span class="report-val">${val}</span>${btnHTML}</td></tr>`;
            };

            addEgressRow('S·ªë l∆∞·ª£ng ng∆∞·ªùi', inputs.people, [{pages: [144, 145], label: 'B·∫£ng G.9 - H·ªá s·ªë s√†n', highlights: ['H·ªá s·ªë kh√¥ng gian s√†n']}]);
            addEgressRow('R·ªông y√™u c·∫ßu (M·∫≠t ƒë·ªô)', `${egress.widthCalc} m`, [{page: 38, label: 'M·ª•c 3.2.4 - T√≠nh to√°n tho√°t n·∫°n', highlights: ['chi·ªÅu r·ªông']}]);
            addEgressRow('R·ªông t·ªëi thi·ªÉu (Quy ƒë·ªãnh)', `${egress.minAllowed} m`, [{page: 39, label: 'M·ª•c 3.2.9 - K√≠ch th∆∞·ªõc t·ªëi thi·ªÉu', highlights: ['1,2 m', '0,8 m']}]);
            addEgressRow('K·∫øt lu·∫≠n (Ch·ªçn max)', `${egress.finalWidth} m`, []);

            egressRows += '</table>';
            
            renderReportCard(report, '2. T√≠nh to√°n Tho√°t n·∫°n', 'ok', `
                ${egressRows}
                <div class="calc-box">
                    K·∫øt qu·∫£ ƒë√£ so s√°nh gi·ªØa t√≠nh to√°n theo m·∫≠t ƒë·ªô d√≤ng ng∆∞·ªùi v√† quy ƒë·ªãnh k√≠ch th∆∞·ªõc t·ªëi thi·ªÉu.
                </div>
            `);
        }
    }

    // --- DOCUMENT VIEWER LOGIC ---
    function openDocViewer(citations) {
        const modal = document.getElementById('doc-modal');
        const content = document.getElementById('doc-viewer-content');
        
        content.innerHTML = '';

        citations.forEach((cit, idx) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'citation-group';
            
            const titleDiv = document.createElement('div');
            titleDiv.className = 'citation-group-title';
            titleDiv.innerText = `CƒÇN C·ª® ${idx + 1}: ${cit.label}`;
            groupDiv.appendChild(titleDiv);

            // X·ª≠ l√Ω m·∫£ng trang ho·∫∑c trang ƒë∆°n
            const pages = cit.pages || [cit.page];

            pages.forEach(pageNum => {
                const pageData = qcvnPages[pageNum] || `<div style="text-align:center; padding-top:100px; color:#999;">(N·ªôi dung trang ${pageNum} ch∆∞a c√≥ trong d·ªØ li·ªáu tr√≠ch xu·∫•t...)</div>`;
                
                const pageDiv = document.createElement('div');
                pageDiv.className = 'doc-page';
                
                let processedContent = pageData;
                if (cit.highlights && cit.highlights.length > 0) {
                    cit.highlights.forEach(keyword => {
                        try {
                            const regex = new RegExp(`(${keyword})`, 'gi');
                            processedContent = processedContent.replace(regex, '<mark class="highlight">$1</mark>');
                        } catch(e) {}
                    });
                }

                pageDiv.innerHTML = `
                    <div class="page-label is-center">TRANG CƒÇN C·ª®</div>
                    <div class="doc-page-header-text">QCVN 06:2022/BXD - B·ªò X√ÇY D·ª∞NG</div>
                    ${processedContent}
                    <div class="doc-page-number">Trang ${pageNum} (PDF)</div>
                `;
                groupDiv.appendChild(pageDiv);
            });
            
            content.appendChild(groupDiv);
        });

        modal.style.display = 'flex';
    }

    function closeDocViewer() {
        document.getElementById('doc-modal').style.display = 'none';
    }

    // --- HELPER LOGIC ---
    function calculateFireGrade(inp) {
        let g = 'III';
        if (inp.h > 50) g = 'I';
        else if (inp.h > 28) g = 'II';
        return { grade: g, status: 'ok' };
    }

    function calculateEgress(people, func) {
        let factor = 100;
        let minW = 1.0;
        if (func === 'F1.1') minW = 1.2;
        
        let wCalc = people / factor;
        let wFinal = Math.max(wCalc, minW);
        return { widthCalc: wCalc.toFixed(2), minAllowed: minW, finalWidth: wFinal.toFixed(2) };
    }

    function renderReportCard(container, title, status, contentHTML) {
        const statusClass = status === 'ok' ? 'st-ok' : (status === 'err' ? 'st-err' : 'st-warn');
        const statusText = status === 'ok' ? 'ƒê·∫†T / ƒê√É T√çNH' : 'L∆ØU √ù';
        
        const html = `
            <div class="report-card">
                <div class="report-header">
                    <div class="report-title">${title}</div>
                    <div class="status-badge ${statusClass}">${statusText}</div>
                </div>
                <div>${contentHTML}</div>
            </div>
        `;
        container.insertAdjacentHTML('beforeend', html);
    }

    function showTab(id, el) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
        el.classList.add('active');
    }
    function toggleRiskInput() {
        const f = document.getElementById('inp-function').value;
        document.getElementById('risk-container').style.display = f.startsWith('F5') ? 'block' : 'none';
    }

    // Filter Table Function
    function filterTable(tableId, inputId) {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById(inputId);
        filter = input.value.toUpperCase();
        table = document.getElementById(tableId);
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[0]; // C·ªôt M√£
            let td2 = tr[i].getElementsByTagName("td")[1]; // C·ªôt M√¥ t·∫£
            if (td || td2) {
                txtValue = (td.textContent || td.innerText) + (td2.textContent || td2.innerText);
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }

    // Check Road Access Function
    function checkRoadAccess() {
        const w = parseFloat(document.getElementById('check-road-width').value) || 0;
        const h = parseFloat(document.getElementById('check-road-height').value) || 0;
        const res = document.getElementById('road-result');
        res.style.display = 'block';

        let msg = '';
        if (w >= 3.5) msg += '<div style="color:green">‚úî Chi·ªÅu r·ªông ƒë·∫°t (>3.5m)</div>';
        else msg += '<div style="color:red">‚úò Chi·ªÅu r·ªông KH√îNG ƒê·∫†T (<3.5m)</div>';

        if (h >= 4.5) msg += '<div style="color:green">‚úî Chi·ªÅu cao ƒë·∫°t (>4.5m)</div>';
        else msg += '<div style="color:red">‚úò Chi·ªÅu cao KH√îNG ƒê·∫†T (<4.5m)</div>';

        res.innerHTML = msg;
    }
</script>

</body>
</html>
